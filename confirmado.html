<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Compra Confirmada | Views</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="confirmation-hero">

  <!-- Logo -->
  <img src="images/logo.png" alt="Logo Views" class="logo">

  <!-- Mensaje -->
  <h1 class="confirmation-title">âœ… Â¡Compra Confirmada!</h1>
  <p class="confirmation-text">
    Gracias por comprar tu ticket para <strong>Views</strong>.<br>
    Tu pago fue procesado correctamente y tu espacio en el evento estÃ¡ reservado.
  </p>
  <p class="confirmation-text">
    ğŸ“© Hemos enviado un comprobante a tu correo electrÃ³nico.<br>
    Nos vemos pronto ğŸš€
  </p>

  <!-- QR dinÃ¡mico -->
  <div class="qr-section" id="qrContainer" style="display:none;">
    <h3>Escanea tu cÃ³digo QR para ingresar al evento</h3>
    <div id="qrCode"></div>
    <button id="downloadQR" class="download-button">ğŸ“¥ Descargar QR</button>
    <button id="downloadPDF" class="download-button">ğŸ“„ Descargar Ticket en PDF</button>
  </div>

  <!-- BotÃ³n para volver -->
  <a href="index.html">
    <button class="back-button">Volver a la pÃ¡gina principal</button>
  </a>

</div>

<footer class="footer">
  <p>Â© 2026 Views. Todos los derechos reservados.</p>
</footer>

<!-- LibrerÃ­as -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
  // Obtener ticket Ãºnico de la URL
  const params = new URLSearchParams(window.location.search);
  const ticketID = params.get("ticket"); // Ej: confirmacion.html?ticket=ABC123

  if(ticketID){
    const qrContainer = document.getElementById("qrContainer");
    qrContainer.style.display = "block";

    const ticketURL = `https://tu-sitio.com/tickets/${ticketID}`;

    // Generar QR
    const qr = new QRCode(document.getElementById("qrCode"), {
      text: ticketURL,
      width: 220,
      height: 220,
      colorDark : "#0e0e0e",
      colorLight : "#ffffff",
      correctLevel : QRCode.CorrectLevel.H
    });

    // Descargar QR como imagen
    document.getElementById("downloadQR").addEventListener("click", function(){
      const qrCanvas = document.querySelector("#qrCode canvas");
      if(!qrCanvas) return;
      const link = document.createElement("a");
      link.href = qrCanvas.toDataURL("image/png");
      link.download = `ticket-${ticketID}.png`;
      link.click();
    });

    // Descargar ticket en PDF
    document.getElementById("downloadPDF").addEventListener("click", async function(){
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      // Logo
      const logoImg = new Image();
      logoImg.src = "images/logo.png";
      logoImg.onload = () => {
        doc.addImage(logoImg, 'PNG', 80, 10, 50, 50);

        // Texto del ticket
        doc.setFontSize(16);
        doc.text("Ticket de acceso - Views", 105, 70, null, null, 'center');
        doc.setFontSize(12);
        doc.text(`ID de Ticket: ${ticketID}`, 105, 80, null, null, 'center');
        doc.text("Evento audiovisual creativo", 105, 90, null, null, 'center');
        doc.text("ğŸ“… Fecha: PrÃ³ximamente", 105, 100, null, null, 'center');
        doc.text("ğŸ“ Lugar: Por confirmar", 105, 110, null, null, 'center');

        // QR en PDF
        const qrCanvas = document.querySelector("#qrCode canvas");
        const qrDataURL = qrCanvas.toDataURL("image/png");
        doc.addImage(qrDataURL, 'PNG', 70, 120, 70, 70);

        doc.save(`ticket-${ticketID}.pdf`);
      };
    });

  } else {
    document.getElementById("qrContainer").innerHTML = "<p style='color:#ff6a00;'>âš ï¸ No se pudo generar el QR. Pago no confirmado.</p>";
  }
</script>

</body>
</html>
